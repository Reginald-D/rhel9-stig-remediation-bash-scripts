#!/bin/bash
# .SYNOPSIS
#   Configures AIDE to enforce cryptographic integrity verification for RHEL 9 audit tools,
#   ensuring detection of unauthorized modifications or tampering.
#
# .NOTES
#   Author: Reggie Ruler
#   Company: No Lack LLC
#   Date: 11/03/2025
#   STIG ID: RHEL-09-651025
#   SRG: SRG-OS-000256-GPOS-00097
#   Severity: Medium
#   CCI: CCI-001493, CCI-001494, CCI-001495, CCI-001496
#   Vulnerability ID: V-258137
#   Purpose: Enforces file integrity verification of audit tools using AIDE and SHA-512 hashing.
#
# .TESTED ON
#   RHEL 9 (STIG-Compliant Build)
#
# .USAGE
#   sudo ./RHEL-09-651025.sh

CONF_FILE="/etc/aide.conf"
TOOLS=(auditctl auditd ausearch aureport autrace augenrules)
for TOOL in "${TOOLS[@]}"; do
  grep -q "/usr/sbin/$TOOL" "$CONF_FILE" || echo "/usr/sbin/$TOOL p+i+n+u+g+s+b+acl+xattrs+sha512" | sudo tee -a "$CONF_FILE"
done
echo "AIDE configuration updated to protect audit tools integrity."
